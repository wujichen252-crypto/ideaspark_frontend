# 新项目创建指南（按当前仓库依赖与风格）

本指南用于从零创建一个与当前 `frontend` 仓库一致的前端项目：`Vue 3 + TypeScript + Vite`，并保持相同的目录组织、别名配置、Naive UI 自动导入、Pinia/Vue Router 使用方式与常用脚本命令。

## 1. 环境要求

- Node.js：≥ 18
- 包管理器：推荐使用 `npm`（本仓库使用 `package-lock.json`）
- IDE：VS Code（推荐安装 Volar）

## 2. 创建项目骨架

在你希望放置新项目的目录下执行（避免交互式创建，便于脚本化）：

```bash
npm create vite@latest my-frontend -- --template vue-ts
cd my-frontend
```

## 3. 安装依赖（对齐本仓库）

### 3.1 安装运行依赖

```bash
npm i @vicons/ionicons5 axios echarts gsap naive-ui pinia vue vue-router
```

如需尽量贴近当前仓库版本，可在安装后将 `package.json` 版本号调整为当前仓库的区间（示例）：

```json
{
  "dependencies": {
    "@vicons/ionicons5": "^0.13.0",
    "axios": "^1.13.2",
    "echarts": "^6.0.0",
    "gsap": "^3.13.0",
    "naive-ui": "^2.43.2",
    "pinia": "^3.0.4",
    "vue": "^3.5.24",
    "vue-router": "^4.6.3"
  }
}
```

### 3.2 安装开发依赖

```bash
npm i -D @types/node @vitejs/plugin-vue @vue/tsconfig sass typescript unplugin-auto-import unplugin-vue-components vite vue-tsc
```

对应当前仓库的版本区间（示例）：

```json
{
  "devDependencies": {
    "@types/node": "^24.10.1",
    "@vitejs/plugin-vue": "^6.0.1",
    "@vue/tsconfig": "^0.8.1",
    "sass": "^1.94.2",
    "typescript": "~5.9.3",
    "unplugin-auto-import": "^20.3.0",
    "unplugin-vue-components": "^30.0.0",
    "vite": "^7.2.4",
    "vue-tsc": "^3.1.4"
  }
}
```

## 4. 对齐 `package.json` 脚本

将 `package.json` 的 `scripts` 调整为与当前仓库一致：

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vue-tsc -b && vite build",
    "preview": "vite preview"
  }
}
```

## 5. Vite 配置：别名 + Naive UI 自动导入

用以下内容替换新项目的 `vite.config.ts`（与当前仓库一致）：

```ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'
import { NaiveUiResolver } from 'unplugin-vue-components/resolvers'

export default defineConfig({
  plugins: [
    vue(),
    AutoImport({
      imports: [
        'vue',
        {
          'naive-ui': ['useDialog', 'useMessage', 'useNotification', 'useLoadingBar']
        }
      ],
      dts: 'src/auto-imports.d.ts'
    }),
    Components({
      resolvers: [NaiveUiResolver()],
      dts: 'src/components.d.ts'
    })
  ],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  server: {
    allowedHosts: true
  }
})
```

完成后会生成（或更新）：

- `src/auto-imports.d.ts`
- `src/components.d.ts`

## 6. TS 配置：路径别名与严格模式

在 `tsconfig.app.json` 中对齐如下关键项：

- `strict: true`
- `baseUrl` 与 `paths` 支持 `@/* -> src/*`
- `include` 包含 `src/**/*.vue`

参考当前仓库：`tsconfig.app.json:1`。

## 7. 目录结构建议（贴近当前仓库）

建议直接按当前仓库的高内聚目录组织：

```text
src/
  api/          # axios 封装、业务接口
  assets/       # 静态资源
  components/   # 通用组件
  composables/  # 组合式逻辑（useXxx）
  layouts/      # 布局组件
  router/       # 路由
  store/        # pinia
  styles/       # 全局样式（reset/variables/mixins）
  views/        # 页面
```

## 8. 全局样式接入（SCSS）

1) 创建 `src/styles/reset.scss`，并在 `src/main.ts` 中引入（当前仓库做法参考 `src/main.ts:1`）。

2) 确保已安装 `sass`，并在组件或全局样式中使用 `lang="scss"`。

## 9. Pinia 与 Router 初始化方式

保持当前仓库的初始化顺序与写法：

- Router：`src/router/index.ts` 里 `createRouter + createWebHistory`（参考 `src/router/index.ts:1`）
- Store：`src/store/index.ts` 导出 `createPinia()` 结果（参考 `src/store/index.ts:1`）
- App 挂载：`src/main.ts` 中 `app.use(store)`、`app.use(router)` 后 `mount`（参考 `src/main.ts:29`）

## 10. Axios 二次封装（与当前仓库一致）

在 `src/api/request.ts` 里创建 axios 实例并设置拦截器，建议对齐当前仓库的结构与字段：

- `baseURL: import.meta.env.VITE_API_BASE_URL || '/api'`
- `timeout: 10000`
- 响应统一结构 `Result<T>`

参考当前仓库：`src/api/request.ts:1`。

如需环境变量，新建 `.env.development`（或 `.env`）：

```bash
VITE_API_BASE_URL=http://localhost:3000
```

## 11. VS Code 推荐扩展

可在 `.vscode/extensions.json` 添加 Volar 推荐（当前仓库已有该配置，参考 `.vscode/extensions.json:1`）。

## 12. 启动与构建

```bash
npm run dev
npm run build
npm run preview
```

说明：

- `npm run build` 会先执行 `vue-tsc -b` 做类型检查，通过后才会执行 `vite build`
- 当前仓库未单独提供 `lint`/`typecheck` 脚本，类型检查已集成到 `build`

## 13. 常见问题

- `Cannot find module '@/xxx'`：检查 `vite.config.ts` 与 `tsconfig.app.json` 的 `@` 别名是否都已配置。
- Naive UI 组件/组合式 API 未自动导入：检查 `vite.config.ts` 中 `Components({ resolvers: [NaiveUiResolver()] })` 与 `AutoImport` 配置，并重启 dev server。
- `VITE_API_BASE_URL` 不生效：确认变量名前缀是 `VITE_`，并重启 `npm run dev`。
